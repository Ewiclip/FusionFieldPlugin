<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Activity Properties Plugin</title>
</head>
<body>
    <h3>Activity Properties Plugin</h3>
    <p>Waiting for activity data...</p>

    <script>
        // Listen for messages from Oracle Fusion Field Service
        window.addEventListener('message', function(event) {
            console.log('Received message:', event.data);
            
            // Handle the 'open' message that contains activity data
            if (event.data && event.data.method === 'open' && event.data.activity) {
                const activity = event.data.activity;
                const aid = activity.aid || 'Not available';
                const astatus = activity.astatus || 'Not available';
                
                alert(`Activity ID: ${aid}\nStatus: ${astatus}`);
            }
        });

        // Send ready message to Oracle to indicate plugin is loaded
        window.parent.postMessage({
            method: 'ready',
            apiVersion: '1.0'
        }, '*');

        // For testing outside Oracle - simulate activity data after 2 seconds
        if (window.self === window.top) {
            setTimeout(() => {
                window.postMessage({
                    method: 'open',
                    activity: {
                        aid: 'ACT-2025-001234',
                        astatus: 'pending'
                    }
                }, '*');
            }, 2000);
        }
    </script>
</body>
</html>